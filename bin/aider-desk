#!/usr/bin/env sh

# Get the directory where this script is located
SCRIPT_DIR="$(dirname "$(readlink -f "$0")")"

# Try different possible locations for the Electron app
PATHS_TO_TRY=(
  "$SCRIPT_DIR/../out/main/index.js"           # Local development
  "$SCRIPT_DIR/../node_modules/aider-desk/out/main/index.js"  # Local install
  "$(dirname "$(which aider-desk)")/../lib/node_modules/aider-desk/out/main/index.js" # Global install
)

for APP_PATH in "${PATHS_TO_TRY[@]}"; do
  if [ -f "$APP_PATH" ]; then
    exec electron "$APP_PATH" "$@"
    exit 0
  fi
done

# If not found, try running through npx
if command -v npx >/dev/null 2>&1; then
  exec npx -y electron "$SCRIPT_DIR/../out/main/index.js" "$@"
else
  echo "Error: Could not find aider-desk installation and npx is not available"
  exit 1
fi
